2025-07-09 07:08:43,111 - __main__ - INFO - 
==================================================
2025-07-09 07:08:43,111 - __main__ - INFO - Testing SAVE/LOAD functionality
2025-07-09 07:08:43,111 - __main__ - INFO - ==================================================

2025-07-09 07:08:45,779 - __main__ - INFO - ‚úì Saved reranking_pruning model to /tmp/tmpjbe9umg3/test_model
2025-07-09 07:08:46,499 - __main__ - INFO - ‚úì Loaded reranking_pruning model successfully
2025-07-09 07:08:48,275 - __main__ - INFO - ‚úì Saved pruning_only model to /tmp/tmptyyr0lll/test_model
2025-07-09 07:08:48,814 - __main__ - INFO - ‚úì Loaded pruning_only model successfully
2025-07-09 07:08:48,848 - __main__ - INFO - 
‚úÖ SAVE/LOAD functionality test PASSED

2025-07-09 07:08:48,953 - __main__ - INFO - 
==================================================
2025-07-09 07:08:48,953 - __main__ - INFO - Testing RERANKING + PRUNING mode with minimal dataset
2025-07-09 07:08:48,953 - __main__ - INFO - ==================================================

2025-07-09 07:08:48,953 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:08:53,638 - __main__ - INFO - Initializing PruningEncoder in reranking_pruning mode
2025-07-09 07:08:54,882 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:08:54,882 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:08:54,903 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['ranking_targets', 'pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:08:54,904 - __main__ - INFO - ‚úì All required label columns present
2025-07-09 07:08:54,904 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:08:54,905 - __main__ - ERROR - ‚ùå RERANKING + PRUNING mode test FAILED: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-07-09 07:08:54,905 - __main__ - ERROR - 
==================================================
2025-07-09 07:08:54,905 - __main__ - ERROR - üí• TESTS FAILED! üí•
2025-07-09 07:08:54,905 - __main__ - ERROR - Error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-07-09 07:08:54,905 - __main__ - ERROR - ==================================================

