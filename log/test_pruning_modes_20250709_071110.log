2025-07-09 07:11:10,156 - __main__ - INFO - 
==================================================
2025-07-09 07:11:10,156 - __main__ - INFO - Testing SAVE/LOAD functionality
2025-07-09 07:11:10,156 - __main__ - INFO - ==================================================

2025-07-09 07:11:12,756 - __main__ - INFO - ‚úì Saved reranking_pruning model to /tmp/tmpecs17tgp/test_model
2025-07-09 07:11:13,513 - __main__ - INFO - ‚úì Loaded reranking_pruning model successfully
2025-07-09 07:11:15,298 - __main__ - INFO - ‚úì Saved pruning_only model to /tmp/tmpbfplk9a_/test_model
2025-07-09 07:11:15,849 - __main__ - INFO - ‚úì Loaded pruning_only model successfully
2025-07-09 07:11:15,884 - __main__ - INFO - 
‚úÖ SAVE/LOAD functionality test PASSED

2025-07-09 07:11:15,989 - __main__ - INFO - 
==================================================
2025-07-09 07:11:15,990 - __main__ - INFO - Testing RERANKING + PRUNING mode with minimal dataset
2025-07-09 07:11:15,990 - __main__ - INFO - ==================================================

2025-07-09 07:11:15,990 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:11:20,279 - __main__ - INFO - Initializing PruningEncoder in reranking_pruning mode
2025-07-09 07:11:21,471 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:11:21,471 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:11:21,493 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['ranking_targets', 'pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:11:21,493 - __main__ - INFO - ‚úì All required label columns present
2025-07-09 07:11:21,493 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:11:21,523 - __main__ - INFO - ‚úì Forward pass successful. Output keys: dict_keys(['ranking_logits', 'pruning_logits', 'hidden_states'])
2025-07-09 07:11:21,753 - __main__ - INFO - ‚úì Loss computation successful. Loss value: 0.5686
2025-07-09 07:11:21,762 - __main__ - INFO - ‚úì Predict (ranking only) successful. Score: [0.09681489]
2025-07-09 07:11:21,769 - __main__ - INFO - ‚úì Predict with pruning successful. Compression ratio: 0.67
2025-07-09 07:11:21,769 - __main__ - INFO - 
‚úÖ RERANKING + PRUNING mode test PASSED for minimal dataset

2025-07-09 07:11:21,879 - __main__ - INFO - 
==================================================
2025-07-09 07:11:21,879 - __main__ - INFO - Testing PRUNING-ONLY mode with minimal dataset
2025-07-09 07:11:21,879 - __main__ - INFO - ==================================================

2025-07-09 07:11:21,879 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:11:24,604 - __main__ - INFO - Initializing PruningEncoder in pruning_only mode
2025-07-09 07:11:25,837 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:11:25,837 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:11:25,838 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 07:11:25,857 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:11:25,857 - __main__ - INFO - ‚úì Label columns correct for pruning_only mode
2025-07-09 07:11:25,857 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:11:25,888 - __main__ - INFO - ‚úì Forward pass successful. Output keys: dict_keys(['pruning_logits', 'hidden_states'])
2025-07-09 07:11:26,129 - __main__ - INFO - ‚úì Loss computation successful. Loss value: 0.3491
2025-07-09 07:11:26,130 - __main__ - INFO - ‚úì Correctly raised error for predict without pruning: predict() returns ranking scores and is not available in pruning_only mode. Use prune_texts() or set apply_pruning=True.
2025-07-09 07:11:26,141 - __main__ - ERROR - ‚ùå PRUNING-ONLY mode test FAILED: 'ranking_logits'
2025-07-09 07:11:26,141 - __main__ - ERROR - 
==================================================
2025-07-09 07:11:26,141 - __main__ - ERROR - üí• TESTS FAILED! üí•
2025-07-09 07:11:26,141 - __main__ - ERROR - Error: 'ranking_logits'
2025-07-09 07:11:26,141 - __main__ - ERROR - ==================================================

