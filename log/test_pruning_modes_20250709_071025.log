2025-07-09 07:10:25,375 - __main__ - INFO - 
==================================================
2025-07-09 07:10:25,375 - __main__ - INFO - Testing SAVE/LOAD functionality
2025-07-09 07:10:25,375 - __main__ - INFO - ==================================================

2025-07-09 07:10:28,290 - __main__ - INFO - ‚úì Saved reranking_pruning model to /tmp/tmp370vs734/test_model
2025-07-09 07:10:29,000 - __main__ - INFO - ‚úì Loaded reranking_pruning model successfully
2025-07-09 07:10:30,752 - __main__ - INFO - ‚úì Saved pruning_only model to /tmp/tmpzqecqph0/test_model
2025-07-09 07:10:31,286 - __main__ - INFO - ‚úì Loaded pruning_only model successfully
2025-07-09 07:10:31,321 - __main__ - INFO - 
‚úÖ SAVE/LOAD functionality test PASSED

2025-07-09 07:10:31,425 - __main__ - INFO - 
==================================================
2025-07-09 07:10:31,426 - __main__ - INFO - Testing RERANKING + PRUNING mode with minimal dataset
2025-07-09 07:10:31,426 - __main__ - INFO - ==================================================

2025-07-09 07:10:31,426 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:10:35,861 - __main__ - INFO - Initializing PruningEncoder in reranking_pruning mode
2025-07-09 07:10:37,159 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:10:37,159 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:10:37,181 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['ranking_targets', 'pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:10:37,181 - __main__ - INFO - ‚úì All required label columns present
2025-07-09 07:10:37,181 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:10:37,226 - __main__ - INFO - ‚úì Forward pass successful. Output keys: dict_keys(['ranking_logits', 'pruning_logits', 'hidden_states'])
2025-07-09 07:10:37,453 - __main__ - INFO - ‚úì Loss computation successful. Loss value: 0.4225
2025-07-09 07:10:37,466 - __main__ - INFO - ‚úì Predict (ranking only) successful. Score: [0.09681489]
2025-07-09 07:10:37,477 - __main__ - INFO - ‚úì Predict with pruning successful. Compression ratio: 1.00
2025-07-09 07:10:37,477 - __main__ - INFO - 
‚úÖ RERANKING + PRUNING mode test PASSED for minimal dataset

2025-07-09 07:10:37,595 - __main__ - INFO - 
==================================================
2025-07-09 07:10:37,595 - __main__ - INFO - Testing PRUNING-ONLY mode with minimal dataset
2025-07-09 07:10:37,596 - __main__ - INFO - ==================================================

2025-07-09 07:10:37,596 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:10:40,669 - __main__ - INFO - Initializing PruningEncoder in pruning_only mode
2025-07-09 07:10:42,171 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:10:42,171 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:10:42,172 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 07:10:42,191 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:10:42,191 - __main__ - INFO - ‚úì Label columns correct for pruning_only mode
2025-07-09 07:10:42,191 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:10:42,226 - __main__ - ERROR - ‚ùå PRUNING-ONLY mode test FAILED: mat1 and mat2 shapes cannot be multiplied (258x256 and 384x2)
2025-07-09 07:10:42,226 - __main__ - ERROR - 
==================================================
2025-07-09 07:10:42,226 - __main__ - ERROR - üí• TESTS FAILED! üí•
2025-07-09 07:10:42,226 - __main__ - ERROR - Error: mat1 and mat2 shapes cannot be multiplied (258x256 and 384x2)
2025-07-09 07:10:42,226 - __main__ - ERROR - ==================================================

