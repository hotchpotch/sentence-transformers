2025-07-09 09:10:16,948 - __main__ - INFO - Starting pruning-only training with full dataset
2025-07-09 09:10:16,949 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-full
2025-07-09 09:10:21,515 - __main__ - INFO - Train dataset size: 500298
2025-07-09 09:10:21,515 - __main__ - INFO - Eval dataset size: 2999
2025-07-09 09:10:21,515 - __main__ - INFO - Dataset columns: ['id', 'query', 'texts', 'chunks_pos', 'labels', 'dataset_name', 'relevant_chunks', 'teacher_scores_japanese-reranker-xsmall-v2']
2025-07-09 09:10:21,515 - __main__ - INFO - Initializing PruningEncoder in pruning_only mode with base model: cl-nagoya/ruri-v3-30m
2025-07-09 09:10:23,891 - __main__ - INFO - Training arguments: {'output_dir': './output/pruning_only_full_20250709_091023', 'num_epochs': 3, 'batch_size': 32, 'learning_rate': 2e-05, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'gradient_accumulation_steps': 1, 'max_grad_norm': 1.0, 'logging_steps': 100, 'eval_steps': 1000, 'save_steps': 1000, 'save_total_limit': 3, 'seed': 42, 'fp16': True, 'dataloader_num_workers': 4}
2025-07-09 09:10:23,892 - __main__ - INFO - Starting training...
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO - ***** Running training *****
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO -   Num examples = 500298
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO -   Num epochs = 3
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO -   Batch size = 32
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO -   Gradient accumulation steps = 1
2025-07-09 09:10:23,892 - sentence_transformers.pruning.trainer - INFO -   Total optimization steps = 46905
2025-07-09 09:10:24,008 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:10:24,009 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:10:24,009 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:10:24,015 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:10:40,738 - sentence_transformers.pruning.trainer - INFO - Step 100, Loss: 4.8825
2025-07-09 09:10:56,692 - sentence_transformers.pruning.trainer - INFO - Step 200, Loss: 2.7474
2025-07-09 09:11:12,628 - sentence_transformers.pruning.trainer - INFO - Step 300, Loss: 1.8787
2025-07-09 09:11:28,564 - sentence_transformers.pruning.trainer - INFO - Step 400, Loss: 1.4352
2025-07-09 09:11:44,502 - sentence_transformers.pruning.trainer - INFO - Step 500, Loss: 1.1644
2025-07-09 09:12:00,424 - sentence_transformers.pruning.trainer - INFO - Step 600, Loss: 0.9826
2025-07-09 09:12:16,353 - sentence_transformers.pruning.trainer - INFO - Step 700, Loss: 0.8520
2025-07-09 09:12:32,282 - sentence_transformers.pruning.trainer - INFO - Step 800, Loss: 0.7534
2025-07-09 09:12:48,203 - sentence_transformers.pruning.trainer - INFO - Step 900, Loss: 0.6766
2025-07-09 09:13:04,108 - sentence_transformers.pruning.trainer - INFO - Step 1000, Loss: 0.6151
2025-07-09 09:13:04,108 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:13:04,235 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:13:04,235 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:13:04,236 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:13:04,236 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:13:11,010 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0590
2025-07-09 09:13:11,322 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091023/checkpoint-1000-best
2025-07-09 09:13:11,322 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091023/checkpoint-1000
2025-07-09 09:13:27,546 - sentence_transformers.pruning.trainer - INFO - Step 1100, Loss: 0.5646
2025-07-09 09:13:43,481 - sentence_transformers.pruning.trainer - INFO - Step 1200, Loss: 0.5223
2025-07-09 09:13:59,409 - sentence_transformers.pruning.trainer - INFO - Step 1300, Loss: 0.4865
