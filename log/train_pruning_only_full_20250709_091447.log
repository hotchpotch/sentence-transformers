2025-07-09 09:14:47,651 - __main__ - INFO - Starting pruning-only training with full dataset
2025-07-09 09:14:47,651 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-full
2025-07-09 09:14:53,149 - __main__ - INFO - Train dataset size: 500298
2025-07-09 09:14:53,149 - __main__ - INFO - Eval dataset size: 2999
2025-07-09 09:14:53,149 - __main__ - INFO - Dataset columns: ['id', 'query', 'texts', 'chunks_pos', 'labels', 'dataset_name', 'relevant_chunks', 'teacher_scores_japanese-reranker-xsmall-v2']
2025-07-09 09:14:53,149 - __main__ - INFO - Initializing PruningEncoder in pruning_only mode with base model: cl-nagoya/ruri-v3-30m
2025-07-09 09:14:55,555 - __main__ - INFO - Training arguments: {'output_dir': './output/pruning_only_full_20250709_091455', 'num_epochs': 1, 'batch_size': 32, 'learning_rate': 2e-05, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'gradient_accumulation_steps': 2, 'max_grad_norm': 1.0, 'logging_steps': 100, 'eval_steps': 1000, 'save_steps': 1000, 'save_total_limit': 3, 'seed': 42, 'fp16': True, 'dataloader_num_workers': 4}
2025-07-09 09:14:55,556 - __main__ - INFO - Starting training...
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO - ***** Running training *****
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO -   Num examples = 500298
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO -   Num epochs = 1
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO -   Batch size = 32
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO -   Gradient accumulation steps = 2
2025-07-09 09:14:55,556 - sentence_transformers.pruning.trainer - INFO -   Total optimization steps = 15635
2025-07-09 09:14:55,676 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:14:55,677 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:14:55,681 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:14:55,683 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:15:28,024 - sentence_transformers.pruning.trainer - INFO - Step 100, Loss: 0.3005
2025-07-09 09:15:59,521 - sentence_transformers.pruning.trainer - INFO - Step 200, Loss: 0.1756
2025-07-09 09:16:30,995 - sentence_transformers.pruning.trainer - INFO - Step 300, Loss: 0.1310
2025-07-09 09:17:02,478 - sentence_transformers.pruning.trainer - INFO - Step 400, Loss: 0.1067
2025-07-09 09:17:33,959 - sentence_transformers.pruning.trainer - INFO - Step 500, Loss: 0.0913
2025-07-09 09:18:05,444 - sentence_transformers.pruning.trainer - INFO - Step 600, Loss: 0.0806
2025-07-09 09:18:36,929 - sentence_transformers.pruning.trainer - INFO - Step 700, Loss: 0.0729
2025-07-09 09:19:08,431 - sentence_transformers.pruning.trainer - INFO - Step 800, Loss: 0.0670
2025-07-09 09:19:39,922 - sentence_transformers.pruning.trainer - INFO - Step 900, Loss: 0.0624
2025-07-09 09:20:11,414 - sentence_transformers.pruning.trainer - INFO - Step 1000, Loss: 0.0585
2025-07-09 09:20:11,415 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:20:11,544 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:20:11,544 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:20:11,544 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:20:11,546 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:20:18,557 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0463
2025-07-09 09:20:18,881 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-1000-best
2025-07-09 09:20:18,882 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-1000
2025-07-09 09:20:50,665 - sentence_transformers.pruning.trainer - INFO - Step 1100, Loss: 0.0553
2025-07-09 09:21:22,152 - sentence_transformers.pruning.trainer - INFO - Step 1200, Loss: 0.0526
2025-07-09 09:21:53,624 - sentence_transformers.pruning.trainer - INFO - Step 1300, Loss: 0.0503
2025-07-09 09:22:25,117 - sentence_transformers.pruning.trainer - INFO - Step 1400, Loss: 0.0483
2025-07-09 09:22:56,596 - sentence_transformers.pruning.trainer - INFO - Step 1500, Loss: 0.0466
2025-07-09 09:23:28,092 - sentence_transformers.pruning.trainer - INFO - Step 1600, Loss: 0.0450
2025-07-09 09:23:59,584 - sentence_transformers.pruning.trainer - INFO - Step 1700, Loss: 0.0436
2025-07-09 09:24:31,058 - sentence_transformers.pruning.trainer - INFO - Step 1800, Loss: 0.0424
2025-07-09 09:25:02,518 - sentence_transformers.pruning.trainer - INFO - Step 1900, Loss: 0.0412
2025-07-09 09:25:34,003 - sentence_transformers.pruning.trainer - INFO - Step 2000, Loss: 0.0402
2025-07-09 09:25:34,003 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:25:34,133 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:25:34,133 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:25:34,133 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:25:34,135 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:25:41,049 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0404
2025-07-09 09:25:41,353 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-2000-best
2025-07-09 09:25:41,354 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-2000
2025-07-09 09:26:13,132 - sentence_transformers.pruning.trainer - INFO - Step 2100, Loss: 0.0393
2025-07-09 09:26:44,622 - sentence_transformers.pruning.trainer - INFO - Step 2200, Loss: 0.0384
2025-07-09 09:27:16,111 - sentence_transformers.pruning.trainer - INFO - Step 2300, Loss: 0.0376
2025-07-09 09:27:47,612 - sentence_transformers.pruning.trainer - INFO - Step 2400, Loss: 0.0369
2025-07-09 09:28:19,103 - sentence_transformers.pruning.trainer - INFO - Step 2500, Loss: 0.0362
2025-07-09 09:28:50,593 - sentence_transformers.pruning.trainer - INFO - Step 2600, Loss: 0.0355
2025-07-09 09:29:22,086 - sentence_transformers.pruning.trainer - INFO - Step 2700, Loss: 0.0350
2025-07-09 09:29:53,577 - sentence_transformers.pruning.trainer - INFO - Step 2800, Loss: 0.0344
2025-07-09 09:30:25,075 - sentence_transformers.pruning.trainer - INFO - Step 2900, Loss: 0.0339
2025-07-09 09:30:56,541 - sentence_transformers.pruning.trainer - INFO - Step 3000, Loss: 0.0334
2025-07-09 09:30:56,541 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:30:56,672 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:30:56,673 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:30:56,673 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:30:56,673 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:31:03,604 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0374
2025-07-09 09:31:03,905 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-3000-best
2025-07-09 09:31:03,906 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-3000
2025-07-09 09:31:35,676 - sentence_transformers.pruning.trainer - INFO - Step 3100, Loss: 0.0330
2025-07-09 09:32:07,168 - sentence_transformers.pruning.trainer - INFO - Step 3200, Loss: 0.0325
2025-07-09 09:32:38,680 - sentence_transformers.pruning.trainer - INFO - Step 3300, Loss: 0.0321
2025-07-09 09:33:10,186 - sentence_transformers.pruning.trainer - INFO - Step 3400, Loss: 0.0317
2025-07-09 09:33:41,669 - sentence_transformers.pruning.trainer - INFO - Step 3500, Loss: 0.0314
2025-07-09 09:34:13,155 - sentence_transformers.pruning.trainer - INFO - Step 3600, Loss: 0.0310
2025-07-09 09:34:44,635 - sentence_transformers.pruning.trainer - INFO - Step 3700, Loss: 0.0307
2025-07-09 09:35:16,126 - sentence_transformers.pruning.trainer - INFO - Step 3800, Loss: 0.0304
2025-07-09 09:35:47,624 - sentence_transformers.pruning.trainer - INFO - Step 3900, Loss: 0.0301
2025-07-09 09:36:19,125 - sentence_transformers.pruning.trainer - INFO - Step 4000, Loss: 0.0298
2025-07-09 09:36:19,125 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:36:19,254 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:36:19,255 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:36:19,256 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:36:19,256 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:36:26,166 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0359
2025-07-09 09:36:26,487 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-4000-best
2025-07-09 09:36:26,487 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-4000
2025-07-09 09:36:26,784 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/pruning_only_full_20250709_091455/checkpoint-1000
2025-07-09 09:36:58,284 - sentence_transformers.pruning.trainer - INFO - Step 4100, Loss: 0.0295
2025-07-09 09:37:29,769 - sentence_transformers.pruning.trainer - INFO - Step 4200, Loss: 0.0292
2025-07-09 09:38:01,253 - sentence_transformers.pruning.trainer - INFO - Step 4300, Loss: 0.0290
2025-07-09 09:38:32,769 - sentence_transformers.pruning.trainer - INFO - Step 4400, Loss: 0.0287
2025-07-09 09:39:04,257 - sentence_transformers.pruning.trainer - INFO - Step 4500, Loss: 0.0285
2025-07-09 09:39:35,727 - sentence_transformers.pruning.trainer - INFO - Step 4600, Loss: 0.0283
2025-07-09 09:40:07,187 - sentence_transformers.pruning.trainer - INFO - Step 4700, Loss: 0.0281
2025-07-09 09:40:38,687 - sentence_transformers.pruning.trainer - INFO - Step 4800, Loss: 0.0278
2025-07-09 09:41:10,181 - sentence_transformers.pruning.trainer - INFO - Step 4900, Loss: 0.0276
2025-07-09 09:41:41,650 - sentence_transformers.pruning.trainer - INFO - Step 5000, Loss: 0.0274
2025-07-09 09:41:41,650 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:41:41,778 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:41:41,778 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:41:41,778 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:41:41,780 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:41:48,735 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0351
2025-07-09 09:41:49,037 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-5000-best
2025-07-09 09:41:49,037 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-5000
2025-07-09 09:41:49,329 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/pruning_only_full_20250709_091455/checkpoint-2000
2025-07-09 09:42:20,844 - sentence_transformers.pruning.trainer - INFO - Step 5100, Loss: 0.0273
2025-07-09 09:42:52,325 - sentence_transformers.pruning.trainer - INFO - Step 5200, Loss: 0.0271
2025-07-09 09:43:23,827 - sentence_transformers.pruning.trainer - INFO - Step 5300, Loss: 0.0269
2025-07-09 09:43:55,326 - sentence_transformers.pruning.trainer - INFO - Step 5400, Loss: 0.0267
2025-07-09 09:44:26,834 - sentence_transformers.pruning.trainer - INFO - Step 5500, Loss: 0.0266
2025-07-09 09:44:58,319 - sentence_transformers.pruning.trainer - INFO - Step 5600, Loss: 0.0264
2025-07-09 09:45:29,811 - sentence_transformers.pruning.trainer - INFO - Step 5700, Loss: 0.0263
2025-07-09 09:46:01,314 - sentence_transformers.pruning.trainer - INFO - Step 5800, Loss: 0.0261
2025-07-09 09:46:32,829 - sentence_transformers.pruning.trainer - INFO - Step 5900, Loss: 0.0260
2025-07-09 09:47:04,324 - sentence_transformers.pruning.trainer - INFO - Step 6000, Loss: 0.0258
2025-07-09 09:47:04,324 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:47:04,452 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:47:04,452 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:47:04,454 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:47:04,457 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:47:11,389 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0340
2025-07-09 09:47:11,700 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-6000-best
2025-07-09 09:47:11,701 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-6000
2025-07-09 09:47:11,994 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/pruning_only_full_20250709_091455/checkpoint-3000
2025-07-09 09:47:43,533 - sentence_transformers.pruning.trainer - INFO - Step 6100, Loss: 0.0257
2025-07-09 09:48:15,036 - sentence_transformers.pruning.trainer - INFO - Step 6200, Loss: 0.0256
2025-07-09 09:48:46,536 - sentence_transformers.pruning.trainer - INFO - Step 6300, Loss: 0.0254
2025-07-09 09:49:18,041 - sentence_transformers.pruning.trainer - INFO - Step 6400, Loss: 0.0253
2025-07-09 09:49:49,516 - sentence_transformers.pruning.trainer - INFO - Step 6500, Loss: 0.0252
2025-07-09 09:50:21,014 - sentence_transformers.pruning.trainer - INFO - Step 6600, Loss: 0.0251
2025-07-09 09:50:52,511 - sentence_transformers.pruning.trainer - INFO - Step 6700, Loss: 0.0250
2025-07-09 09:51:24,029 - sentence_transformers.pruning.trainer - INFO - Step 6800, Loss: 0.0248
2025-07-09 09:51:55,541 - sentence_transformers.pruning.trainer - INFO - Step 6900, Loss: 0.0247
2025-07-09 09:52:27,048 - sentence_transformers.pruning.trainer - INFO - Step 7000, Loss: 0.0246
2025-07-09 09:52:27,048 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:52:27,176 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:52:27,176 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:52:27,177 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:52:27,184 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:52:34,123 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0339
2025-07-09 09:52:34,429 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-7000-best
2025-07-09 09:52:34,429 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-7000
2025-07-09 09:52:34,724 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/pruning_only_full_20250709_091455/checkpoint-4000
2025-07-09 09:53:06,253 - sentence_transformers.pruning.trainer - INFO - Step 7100, Loss: 0.0245
2025-07-09 09:53:37,749 - sentence_transformers.pruning.trainer - INFO - Step 7200, Loss: 0.0244
2025-07-09 09:54:09,246 - sentence_transformers.pruning.trainer - INFO - Step 7300, Loss: 0.0243
2025-07-09 09:54:40,737 - sentence_transformers.pruning.trainer - INFO - Step 7400, Loss: 0.0242
2025-07-09 09:55:12,221 - sentence_transformers.pruning.trainer - INFO - Step 7500, Loss: 0.0241
2025-07-09 09:55:43,704 - sentence_transformers.pruning.trainer - INFO - Step 7600, Loss: 0.0240
2025-07-09 09:56:15,207 - sentence_transformers.pruning.trainer - INFO - Step 7700, Loss: 0.0239
2025-07-09 09:56:46,695 - sentence_transformers.pruning.trainer - INFO - Step 7800, Loss: 0.0239
2025-07-09 09:56:52,229 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 09:56:52,354 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:56:52,354 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:56:52,354 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:56:52,357 - sentence_transformers.pruning.data_collator - INFO - Note: 'labels' column found but will be ignored in pruning_only mode
2025-07-09 09:56:59,379 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.0333
2025-07-09 09:56:59,693 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/pruning_only_full_20250709_091455/checkpoint-7817-best
2025-07-09 09:56:59,693 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/pruning_only_full_20250709_091455/checkpoint-7817
2025-07-09 09:56:59,991 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/pruning_only_full_20250709_091455/checkpoint-5000
2025-07-09 09:57:00,024 - sentence_transformers.pruning.trainer - INFO - Training completed!
2025-07-09 09:57:00,024 - sentence_transformers.pruning.trainer - INFO - Loading best model from ./output/pruning_only_full_20250709_091455/checkpoint-7817-best
2025-07-09 09:57:00,788 - __main__ - INFO - Saving final model to ./output/pruning_only_full_20250709_091455/final_model
2025-07-09 09:57:01,068 - __main__ - INFO - Training completed!
