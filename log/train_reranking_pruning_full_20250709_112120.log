2025-07-09 11:21:20,162 - __main__ - INFO - Starting reranking + pruning training with full dataset
2025-07-09 11:21:20,162 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-full
2025-07-09 11:21:25,240 - __main__ - INFO - Train dataset size: 500298
2025-07-09 11:21:25,240 - __main__ - INFO - Eval dataset size: 2999
2025-07-09 11:21:25,240 - __main__ - INFO - Dataset columns: ['id', 'query', 'texts', 'chunks_pos', 'labels', 'dataset_name', 'relevant_chunks', 'teacher_scores_japanese-reranker-xsmall-v2']
2025-07-09 11:21:25,240 - __main__ - INFO - Initializing PruningEncoder in reranking_pruning mode with base model: hotchpotch/japanese-reranker-xsmall-v2
2025-07-09 11:21:27,505 - __main__ - INFO - Training arguments: {'output_dir': './output/reranking_pruning_full_20250709_112127', 'num_epochs': 1, 'batch_size': 32, 'learning_rate': 2e-05, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'gradient_accumulation_steps': 2, 'max_grad_norm': 1.0, 'logging_steps': 100, 'eval_steps': 1000, 'save_steps': 1000, 'save_total_limit': 3, 'seed': 42, 'fp16': True, 'dataloader_num_workers': 4}
2025-07-09 11:21:27,507 - __main__ - INFO - Starting training...
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO - ***** Running training *****
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO -   Num examples = 500298
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO -   Num epochs = 1
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO -   Batch size = 32
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO -   Gradient accumulation steps = 2
2025-07-09 11:21:27,507 - sentence_transformers.pruning.trainer - INFO -   Total optimization steps = 15635
2025-07-09 11:22:02,367 - sentence_transformers.pruning.trainer - INFO - Step 100, Loss: 0.2869
2025-07-09 11:22:36,267 - sentence_transformers.pruning.trainer - INFO - Step 200, Loss: 0.1933
2025-07-09 11:23:10,222 - sentence_transformers.pruning.trainer - INFO - Step 300, Loss: 0.1561
2025-07-09 11:23:44,102 - sentence_transformers.pruning.trainer - INFO - Step 400, Loss: 0.1362
2025-07-09 11:24:18,049 - sentence_transformers.pruning.trainer - INFO - Step 500, Loss: 0.1237
2025-07-09 11:24:51,959 - sentence_transformers.pruning.trainer - INFO - Step 600, Loss: 0.1150
2025-07-09 11:25:25,879 - sentence_transformers.pruning.trainer - INFO - Step 700, Loss: 0.1086
2025-07-09 11:25:59,822 - sentence_transformers.pruning.trainer - INFO - Step 800, Loss: 0.1037
2025-07-09 11:26:33,751 - sentence_transformers.pruning.trainer - INFO - Step 900, Loss: 0.0997
2025-07-09 11:27:07,674 - sentence_transformers.pruning.trainer - INFO - Step 1000, Loss: 0.0965
2025-07-09 11:27:07,674 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:27:15,016 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1327
2025-07-09 11:27:15,313 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-1000-best
2025-07-09 11:27:15,313 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-1000
2025-07-09 11:27:49,453 - sentence_transformers.pruning.trainer - INFO - Step 1100, Loss: 0.0939
2025-07-09 11:28:23,357 - sentence_transformers.pruning.trainer - INFO - Step 1200, Loss: 0.0915
2025-07-09 11:28:57,474 - sentence_transformers.pruning.trainer - INFO - Step 1300, Loss: 0.0895
2025-07-09 11:29:31,423 - sentence_transformers.pruning.trainer - INFO - Step 1400, Loss: 0.0879
2025-07-09 11:30:05,317 - sentence_transformers.pruning.trainer - INFO - Step 1500, Loss: 0.0865
2025-07-09 11:30:39,219 - sentence_transformers.pruning.trainer - INFO - Step 1600, Loss: 0.0852
2025-07-09 11:31:13,126 - sentence_transformers.pruning.trainer - INFO - Step 1700, Loss: 0.0840
2025-07-09 11:31:47,022 - sentence_transformers.pruning.trainer - INFO - Step 1800, Loss: 0.0830
2025-07-09 11:32:20,873 - sentence_transformers.pruning.trainer - INFO - Step 1900, Loss: 0.0820
2025-07-09 11:32:54,720 - sentence_transformers.pruning.trainer - INFO - Step 2000, Loss: 0.0811
2025-07-09 11:32:54,720 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:33:01,807 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1259
2025-07-09 11:33:02,097 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-2000-best
2025-07-09 11:33:02,097 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-2000
2025-07-09 11:33:36,293 - sentence_transformers.pruning.trainer - INFO - Step 2100, Loss: 0.0804
2025-07-09 11:34:10,203 - sentence_transformers.pruning.trainer - INFO - Step 2200, Loss: 0.0797
2025-07-09 11:34:44,060 - sentence_transformers.pruning.trainer - INFO - Step 2300, Loss: 0.0790
2025-07-09 11:35:17,908 - sentence_transformers.pruning.trainer - INFO - Step 2400, Loss: 0.0783
2025-07-09 11:35:51,786 - sentence_transformers.pruning.trainer - INFO - Step 2500, Loss: 0.0777
2025-07-09 11:36:25,645 - sentence_transformers.pruning.trainer - INFO - Step 2600, Loss: 0.0771
2025-07-09 11:36:59,508 - sentence_transformers.pruning.trainer - INFO - Step 2700, Loss: 0.0766
2025-07-09 11:37:33,398 - sentence_transformers.pruning.trainer - INFO - Step 2800, Loss: 0.0762
2025-07-09 11:38:07,305 - sentence_transformers.pruning.trainer - INFO - Step 2900, Loss: 0.0758
2025-07-09 11:38:41,195 - sentence_transformers.pruning.trainer - INFO - Step 3000, Loss: 0.0753
2025-07-09 11:38:41,195 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:38:48,606 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1239
2025-07-09 11:38:48,895 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-3000-best
2025-07-09 11:38:48,895 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-3000
2025-07-09 11:39:23,072 - sentence_transformers.pruning.trainer - INFO - Step 3100, Loss: 0.0749
2025-07-09 11:39:56,965 - sentence_transformers.pruning.trainer - INFO - Step 3200, Loss: 0.0746
2025-07-09 11:40:30,847 - sentence_transformers.pruning.trainer - INFO - Step 3300, Loss: 0.0742
2025-07-09 11:41:04,715 - sentence_transformers.pruning.trainer - INFO - Step 3400, Loss: 0.0738
2025-07-09 11:41:38,568 - sentence_transformers.pruning.trainer - INFO - Step 3500, Loss: 0.0735
2025-07-09 11:42:12,387 - sentence_transformers.pruning.trainer - INFO - Step 3600, Loss: 0.0732
2025-07-09 11:42:46,183 - sentence_transformers.pruning.trainer - INFO - Step 3700, Loss: 0.0729
2025-07-09 11:43:20,026 - sentence_transformers.pruning.trainer - INFO - Step 3800, Loss: 0.0726
2025-07-09 11:43:53,926 - sentence_transformers.pruning.trainer - INFO - Step 3900, Loss: 0.0723
2025-07-09 11:44:27,793 - sentence_transformers.pruning.trainer - INFO - Step 4000, Loss: 0.0720
2025-07-09 11:44:27,793 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:44:35,113 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1214
2025-07-09 11:44:35,409 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-4000-best
2025-07-09 11:44:35,410 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-4000
2025-07-09 11:44:35,690 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/reranking_pruning_full_20250709_112127/checkpoint-1000
2025-07-09 11:45:09,557 - sentence_transformers.pruning.trainer - INFO - Step 4100, Loss: 0.0718
2025-07-09 11:45:43,385 - sentence_transformers.pruning.trainer - INFO - Step 4200, Loss: 0.0716
2025-07-09 11:46:17,237 - sentence_transformers.pruning.trainer - INFO - Step 4300, Loss: 0.0713
2025-07-09 11:46:51,144 - sentence_transformers.pruning.trainer - INFO - Step 4400, Loss: 0.0711
2025-07-09 11:47:25,226 - sentence_transformers.pruning.trainer - INFO - Step 4500, Loss: 0.0709
2025-07-09 11:47:59,129 - sentence_transformers.pruning.trainer - INFO - Step 4600, Loss: 0.0707
2025-07-09 11:48:33,016 - sentence_transformers.pruning.trainer - INFO - Step 4700, Loss: 0.0705
2025-07-09 11:49:06,915 - sentence_transformers.pruning.trainer - INFO - Step 4800, Loss: 0.0703
2025-07-09 11:49:40,821 - sentence_transformers.pruning.trainer - INFO - Step 4900, Loss: 0.0701
2025-07-09 11:50:14,720 - sentence_transformers.pruning.trainer - INFO - Step 5000, Loss: 0.0699
2025-07-09 11:50:14,721 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:50:21,778 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1196
2025-07-09 11:50:22,069 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-5000-best
2025-07-09 11:50:22,069 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-5000
2025-07-09 11:50:22,348 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/reranking_pruning_full_20250709_112127/checkpoint-2000
2025-07-09 11:50:56,233 - sentence_transformers.pruning.trainer - INFO - Step 5100, Loss: 0.0698
2025-07-09 11:51:30,102 - sentence_transformers.pruning.trainer - INFO - Step 5200, Loss: 0.0696
2025-07-09 11:52:03,965 - sentence_transformers.pruning.trainer - INFO - Step 5300, Loss: 0.0694
2025-07-09 11:52:37,853 - sentence_transformers.pruning.trainer - INFO - Step 5400, Loss: 0.0692
2025-07-09 11:53:11,743 - sentence_transformers.pruning.trainer - INFO - Step 5500, Loss: 0.0691
2025-07-09 11:53:45,657 - sentence_transformers.pruning.trainer - INFO - Step 5600, Loss: 0.0689
2025-07-09 11:54:19,488 - sentence_transformers.pruning.trainer - INFO - Step 5700, Loss: 0.0688
2025-07-09 11:54:53,337 - sentence_transformers.pruning.trainer - INFO - Step 5800, Loss: 0.0686
2025-07-09 11:55:27,154 - sentence_transformers.pruning.trainer - INFO - Step 5900, Loss: 0.0685
2025-07-09 11:56:01,009 - sentence_transformers.pruning.trainer - INFO - Step 6000, Loss: 0.0683
2025-07-09 11:56:01,009 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 11:56:08,078 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1191
2025-07-09 11:56:08,373 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-6000-best
2025-07-09 11:56:08,373 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-6000
2025-07-09 11:56:08,655 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/reranking_pruning_full_20250709_112127/checkpoint-3000
2025-07-09 11:56:42,555 - sentence_transformers.pruning.trainer - INFO - Step 6100, Loss: 0.0682
2025-07-09 11:57:16,397 - sentence_transformers.pruning.trainer - INFO - Step 6200, Loss: 0.0681
2025-07-09 11:57:50,239 - sentence_transformers.pruning.trainer - INFO - Step 6300, Loss: 0.0680
2025-07-09 11:58:24,077 - sentence_transformers.pruning.trainer - INFO - Step 6400, Loss: 0.0678
2025-07-09 11:58:57,905 - sentence_transformers.pruning.trainer - INFO - Step 6500, Loss: 0.0677
2025-07-09 11:59:31,823 - sentence_transformers.pruning.trainer - INFO - Step 6600, Loss: 0.0676
2025-07-09 12:00:05,696 - sentence_transformers.pruning.trainer - INFO - Step 6700, Loss: 0.0675
2025-07-09 12:00:39,604 - sentence_transformers.pruning.trainer - INFO - Step 6800, Loss: 0.0674
2025-07-09 12:01:13,463 - sentence_transformers.pruning.trainer - INFO - Step 6900, Loss: 0.0673
2025-07-09 12:01:47,276 - sentence_transformers.pruning.trainer - INFO - Step 7000, Loss: 0.0672
2025-07-09 12:01:47,276 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 12:01:54,603 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1181
2025-07-09 12:01:54,902 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-7000-best
2025-07-09 12:01:54,902 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-7000
2025-07-09 12:01:55,187 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/reranking_pruning_full_20250709_112127/checkpoint-4000
2025-07-09 12:02:29,071 - sentence_transformers.pruning.trainer - INFO - Step 7100, Loss: 0.0671
2025-07-09 12:03:02,958 - sentence_transformers.pruning.trainer - INFO - Step 7200, Loss: 0.0669
2025-07-09 12:03:36,800 - sentence_transformers.pruning.trainer - INFO - Step 7300, Loss: 0.0668
2025-07-09 12:04:10,603 - sentence_transformers.pruning.trainer - INFO - Step 7400, Loss: 0.0667
2025-07-09 12:04:44,423 - sentence_transformers.pruning.trainer - INFO - Step 7500, Loss: 0.0666
2025-07-09 12:05:18,284 - sentence_transformers.pruning.trainer - INFO - Step 7600, Loss: 0.0666
2025-07-09 12:05:52,325 - sentence_transformers.pruning.trainer - INFO - Step 7700, Loss: 0.0665
2025-07-09 12:06:26,198 - sentence_transformers.pruning.trainer - INFO - Step 7800, Loss: 0.0664
2025-07-09 12:06:32,141 - sentence_transformers.pruning.trainer - INFO - Running evaluation...
2025-07-09 12:06:39,259 - sentence_transformers.pruning.trainer - INFO - Eval loss: 0.1175
2025-07-09 12:06:39,553 - sentence_transformers.pruning.trainer - INFO - New best model saved to ./output/reranking_pruning_full_20250709_112127/checkpoint-7817-best
2025-07-09 12:06:39,553 - sentence_transformers.pruning.trainer - INFO - Saving checkpoint to ./output/reranking_pruning_full_20250709_112127/checkpoint-7817
2025-07-09 12:06:39,833 - sentence_transformers.pruning.trainer - INFO - Deleting checkpoint output/reranking_pruning_full_20250709_112127/checkpoint-5000
2025-07-09 12:06:39,867 - sentence_transformers.pruning.trainer - INFO - Training completed!
2025-07-09 12:06:39,867 - sentence_transformers.pruning.trainer - INFO - Loading best model from ./output/reranking_pruning_full_20250709_112127/checkpoint-7817-best
2025-07-09 12:06:40,431 - __main__ - INFO - Saving final model to ./output/reranking_pruning_full_20250709_112127/final_model
2025-07-09 12:06:40,708 - __main__ - INFO - Training completed!
