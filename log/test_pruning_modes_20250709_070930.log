2025-07-09 07:09:30,112 - __main__ - INFO - 
==================================================
2025-07-09 07:09:30,112 - __main__ - INFO - Testing SAVE/LOAD functionality
2025-07-09 07:09:30,112 - __main__ - INFO - ==================================================

2025-07-09 07:09:32,732 - __main__ - INFO - ‚úì Saved reranking_pruning model to /tmp/tmp8wtjl1ci/test_model
2025-07-09 07:09:33,489 - __main__ - INFO - ‚úì Loaded reranking_pruning model successfully
2025-07-09 07:09:35,244 - __main__ - INFO - ‚úì Saved pruning_only model to /tmp/tmp_1xqg95i/test_model
2025-07-09 07:09:35,826 - __main__ - INFO - ‚úì Loaded pruning_only model successfully
2025-07-09 07:09:35,862 - __main__ - INFO - 
‚úÖ SAVE/LOAD functionality test PASSED

2025-07-09 07:09:35,967 - __main__ - INFO - 
==================================================
2025-07-09 07:09:35,967 - __main__ - INFO - Testing RERANKING + PRUNING mode with minimal dataset
2025-07-09 07:09:35,967 - __main__ - INFO - ==================================================

2025-07-09 07:09:35,967 - __main__ - INFO - Loading dataset: hotchpotch/wip-query-context-pruner-with-teacher-scores/ja-minimal
2025-07-09 07:09:40,418 - __main__ - INFO - Initializing PruningEncoder in reranking_pruning mode
2025-07-09 07:09:41,775 - __main__ - INFO - ‚úì Model initialized successfully
2025-07-09 07:09:41,775 - __main__ - INFO - ‚úì Data collator initialized successfully
2025-07-09 07:09:41,797 - __main__ - INFO - ‚úì Data collation successful. Batch keys: dict_keys(['ranking_targets', 'pruning_labels', 'batch_indices', 'doc_indices', 'docs_per_query'])
2025-07-09 07:09:41,797 - __main__ - INFO - ‚úì All required label columns present
2025-07-09 07:09:41,798 - __main__ - INFO - ‚úì Loss function initialized successfully
2025-07-09 07:09:41,937 - __main__ - INFO - ‚úì Forward pass successful. Output keys: dict_keys(['ranking_logits', 'pruning_logits', 'hidden_states'])
2025-07-09 07:09:41,940 - __main__ - ERROR - ‚ùå RERANKING + PRUNING mode test FAILED: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-07-09 07:09:41,940 - __main__ - ERROR - 
==================================================
2025-07-09 07:09:41,940 - __main__ - ERROR - üí• TESTS FAILED! üí•
2025-07-09 07:09:41,940 - __main__ - ERROR - Error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-07-09 07:09:41,940 - __main__ - ERROR - ==================================================

